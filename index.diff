diff --git a/index.html b/index.html
index 80ad1dfd30df8d49f6cc3f86fba7e5c4f9e2980b..e989d8b5891931f7df1b216ce13fafafa3733593 100644
--- a/index.html
+++ b/index.html
@@ -741,50 +741,72 @@
 
     const PART_TO_PARTSTYPE = {
       "무기": 1,
       "엠블렘": 2,
       "보조무기": 3,
       "포스실드": 4,
       "소울링": 4,
       "방패": 5,
       "모자": 6,
       "상의": 7,
       "한벌옷": 8,
       "하의": 9,
       "신발": 10,
       "장갑": 11,
       "망토": 12,
       "벨트": 13,
       "어깨장식": 14,
       "얼굴장식": 15,
       "눈장식": 16,
       "귀고리": 17,
       "반지": 18,
       "펜던트": 19,
       "기계심장": 20
     };
 
+    function normalizePartKey(name) {
+      return String(name || "").trim();
+    }
+
+    function resolvePartsType(partName, slotName, slotNo) {
+      const normalizedPart = normalizePartKey(partName);
+      if (normalizedPart && PART_TO_PARTSTYPE[normalizedPart]) {
+        return PART_TO_PARTSTYPE[normalizedPart];
+      }
+      const normalizedSlot = normalizePartKey(slotName);
+      if (normalizedSlot && PART_TO_PARTSTYPE[normalizedSlot]) {
+        return PART_TO_PARTSTYPE[normalizedSlot];
+      }
+
+      const slotNumeric = Number(slotNo ?? normalizedSlot);
+      if (Number.isFinite(slotNumeric) && slotNumeric >= 1 && slotNumeric <= 20) {
+        return slotNumeric;
+      }
+
+      return null;
+    }
+
     function isLegendary(grade) {
       return grade === "레전드리";
     }
 
     function getGradeInitial(grade) {
       if (!grade) return "-";
       const trimmed = String(grade).trim();
       return trimmed ? trimmed.charAt(0) : "-";
     }
 
     function formatDateYYYYMMDD(d) {
       const y = d.getFullYear();
       const m = String(d.getMonth() + 1).padStart(2, "0");
       const day = String(d.getDate()).padStart(2, "0");
       return `${y}-${m}-${day}`;
     }
 
     function getDefaultNxDate() {
       // Open API는 지연이 있을 수 있어 기본은 전일
       const d = new Date();
       d.setDate(d.getDate() - 1);
       return formatDateYYYYMMDD(d);
     }
 
     function setMyEquipStatus(text, isError=false) {
@@ -825,51 +847,53 @@
       }
       return res.json();
     }
 
     async function fetchOcidByName(name, apiKey) {
       const q = encodeURIComponent(name.trim());
       return nxFetch(`/id?character_name=${q}`, apiKey);
     }
 
     async function fetchItemEquipment(ocid, apiKey, dateStr) {
       const qOcid = encodeURIComponent(ocid);
       const qDate = encodeURIComponent(dateStr);
       return nxFetch(`/character/item-equipment?ocid=${qOcid}&date=${qDate}`, apiKey);
     }
 
     function normalizeNxEquipItems(raw, presetNo) {
       if (!raw) return [];
       const list = raw.item_equipment || [];
       const out = [];
       list.forEach((it, idx) => {
         // preset: item_equipment_preset_no 값이 있는 경우만 필터
         const pno = it.item_equipment_preset_no;
         if (presetNo && pno && String(pno) !== String(presetNo)) return;
 
         const partName = it.item_equipment_part || "";
-        const partsType = PART_TO_PARTSTYPE[partName] ?? null;
+        const slotName = it.item_equipment_slot || "";
+        const slotNo = it.item_equipment_slot_no ?? it.item_equipment_slot;
+        const partsType = resolvePartsType(partName, slotName, slotNo);
 
         const mainGrade = it.potential_option_grade ?? null;
         const addGrade  = it.additional_potential_option_grade ?? null;
 
         const key = `${partName}|${it.item_name}|${it.item_equipment_slot || ""}|${idx}`;
 
         out.push({
           key,
           idx,
           item_name: it.item_name,
           partName,
           partsType,
           reqLev: it.item_base_option?.base_equipment_level ?? it.item_base_option?.base_req_level ?? it.item_description?.req_lev ?? it.item_equipment_req_level ?? it.item_equipment_level ?? it.item_equipment_req_lev ?? it.item_equipment_reqlev ?? it.item_req_lev ?? it.item_equipment_req ?? it.item_equipment_req_level ?? it.item_equipment_req_lev, // defensive
           // most reliable in your sample: item_equipment_req_level
           reqLev2: it.item_equipment_req_level,
           mainGrade,
           addGrade,
           mainLines: [it.potential_option_1, it.potential_option_2, it.potential_option_3].filter(Boolean),
           addLines: [it.additional_potential_option_1, it.additional_potential_option_2, it.additional_potential_option_3].filter(Boolean),
         });
       });
 
       // reqLev 정리: sample 기준 item_equipment_req_level 사용
       out.forEach(o => {
         const v = Number(o.reqLev2 ?? o.reqLev);
